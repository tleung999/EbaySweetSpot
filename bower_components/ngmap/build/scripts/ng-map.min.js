var ngMap={services:{},directives:{}};ngMap.services.Attr2Options=function($parse,NavigatorGeolocation,GeoCoder){var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,camelCase=function(e){return e.replace(SPECIAL_CHARS_REGEXP,function(e,t,o,a){return a?o.toUpperCase():o}).replace(MOZ_HACK_REGEXP,"Moz$1")},toOptionValue=function(input,options){var output,key=options.key,scope=options.scope;try{var num=Number(input);if(isNaN(num))throw"Not a number";output=num}catch(err){try{if(output=JSON.parse(input),output instanceof Array){if(!(output[0]instanceof Array))return new google.maps.LatLng(output[0],output[1]);output=output.map(function(e){return new google.maps.LatLng(e[0],e[1])})}}catch(err2){if(input.match(/^[A-Z][a-zA-Z0-9]+\(.*\)$/))try{var exp="new google.maps."+input;output=eval(exp)}catch(e){output=input}else if(input.match(/^[A-Z][a-zA-Z0-9]+\.[A-Z]+$/))try{output=scope.$eval("google.maps."+input)}catch(e){output=input}else if(input.match(/^[A-Z]+$/))try{var capitializedKey=key.charAt(0).toUpperCase()+key.slice(1);output=scope.$eval("google.maps."+capitializedKey+"."+input)}catch(e){output=input}else output=input}}return output},setDelayedGeoLocation=function(e,t,o,a){a=a||{};var n=e.centered||a.centered,r=function(){var o=a.fallbackLocation||new google.maps.LatLng(0,0);e[t](o)};!o||o.match(/^current/i)?NavigatorGeolocation.getCurrentPosition().then(function(o){var a=o.coords.latitude,r=o.coords.longitude,i=new google.maps.LatLng(a,r);e[t](i),n&&e.map.setCenter(i)},r):GeoCoder.geocode({address:o}).then(function(o){e[t](o[0].geometry.location),n&&e.map.setCenter(o[0].geometry.location)},r)},observeAndSet=function(e,t,o){e.$observe(t,function(e){if(e){var a=camelCase("set-"+t),n=toOptionValue(e,{key:t});o[a]&&(t.match(/center|position/)&&"string"==typeof n?setDelayedGeoLocation(o,a,n):o[a](n))}})};return{filter:function(e){var t={};for(var o in e)o.match(/^\$/)||(t[o]=e[o]);return t},getOptions:function(e,t){var o={};for(var a in e)if(e[a]){if(a.match(/^on[A-Z]/))continue;if(a.match(/ControlOptions$/))continue;o[a]=toOptionValue(e[a],{scope:t,key:a})}return o},getEvents:function(e,t){var o={},a=function(e){return"_"+e.toLowerCase()},n=function(t){var o=t.match(/([^\(]+)\(([^\)]*)\)/),a=o[1],n=o[2].replace(/event[ ,]*/,""),r=e.$eval("["+n+"]");return function(t){e[a].apply(this,[t].concat(r))}};for(var r in t)if(t[r]){if(!r.match(/^on[A-Z]/))continue;var i=r.replace(/^on/,"");i=i.charAt(0).toLowerCase()+i.slice(1),i=i.replace(/([A-Z])/g,a);var s=t[r];o[i]=new n(s)}return o},getControlOptions:function(e){var t={};if("object"!=typeof e)return!1;for(var o in e)if(e[o]){if(!o.match(/(.*)ControlOptions$/))continue;var a=e[o],n=a.replace(/'/g,'"');n=n.replace(/([^"]+)|("[^"]+")/g,function(e,t,o){return t?t.replace(/([a-zA-Z0-9]+?):/g,'"$1":'):o});try{var r=JSON.parse(n);for(var i in r)if(r[i]){var s=r[i];if("string"==typeof s?s=s.toUpperCase():"mapTypeIds"===i&&(s=s.map(function(e){return google.maps.MapTypeId[e.toUpperCase()]})),"style"===i){var c=o.charAt(0).toUpperCase()+o.slice(1),p=c.replace(/Options$/,"")+"Style";r[i]=google.maps[p][s]}else r[i]="position"===i?google.maps.ControlPosition[s]:s}t[o]=r}catch(l){}}return t},getAttrsToObserve:function(e){var t=[];if(e["ng-repeat"]||e.ngRepeat);else for(var o in e){var a=e[o];a&&a.match(/\{\{.*\}\}/)&&t.push(camelCase(o))}return t},toOptionValue:toOptionValue,camelCase:camelCase,setDelayedGeoLocation:setDelayedGeoLocation,observeAndSet:observeAndSet}},ngMap.services.Attr2Options.$inject=["$parse","NavigatorGeolocation","GeoCoder"],ngMap.services.GeoCoder=function(e){return{geocode:function(t){var o=e.defer(),a=new google.maps.Geocoder;return a.geocode(t,function(e,t){t==google.maps.GeocoderStatus.OK?o.resolve(e):o.reject("Geocoder failed due to: "+t)}),o.promise}}},ngMap.services.GeoCoder.$inject=["$q"],ngMap.services.NavigatorGeolocation=function(e){return{getCurrentPosition:function(){var t=e.defer();return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t.resolve(e)},function(e){t.reject(e)}):t.reject("Browser Geolocation service failed."),t.promise},watchPosition:function(){return"TODO"},clearWatch:function(){return"TODO"}}},ngMap.services.NavigatorGeolocation.$inject=["$q"],ngMap.services.StreetView=function(e){return{getPanorama:function(t,o){o=o||t.getCenter();var a=e.defer(),n=new google.maps.StreetViewService;return n.getPanoramaByLocation(o||t.getCenter,100,function(e,t){t===google.maps.StreetViewStatus.OK?a.resolve(e.location.pano):a.resolve(!1)}),a.promise},setPanorama:function(e,t){var o=new google.maps.StreetViewPanorama(e.getDiv(),{enableCloseButton:!0});o.setPano(t)}}},ngMap.services.StreetView.$inject=["$q"],ngMap.directives.map=function(e){var t=e;return{restrict:"AE",controller:ngMap.directives.MapController,link:function(o,a,n,r){o.google=google;var i=document.createElement("div");i.style.width="100%",i.style.height="100%",a.prepend(i);var s=t.filter(n),c=t.getOptions(s,o),p=t.getControlOptions(s),l=angular.extend(c,p);l.zoom=l.zoom||15;for(var g={},u=0;u<a[0].attributes.length;u++){var v=a[0].attributes[u];g[v.name]=v.value}var m=new google.maps.Map(i,{});m.markers={},m.shapes={};var f=l.center;f instanceof google.maps.LatLng||(delete c.center,e.setDelayedGeoLocation(m,"setCenter",f,c.geoFallbackCenter)),m.setOptions(c);var d=t.getEvents(o,s);for(var h in d)h&&google.maps.event.addListener(m,h,d[h]);for(var y=t.getAttrsToObserve(g),u=0;u<y.length;u++)t.observeAndSet(n,y[u],m);r.map=m,r.addObjects(r._objects),o.map=m,o.$emit("mapInitialized",o.map),o.maps=o.maps||{},o.maps[c.id||Object.keys(o.maps).length]=m,o.$emit("mapsInitialized",o.maps)}}},ngMap.directives.map.$inject=["Attr2Options"],ngMap.directives.MapController=function(){this.map=null,this._objects=[],this.addMarker=function(e){if(this.map){this.map.markers=this.map.markers||{},e.setMap(this.map),e.centered&&this.map.setCenter(e.position);var t=Object.keys(this.map.markers).length;this.map.markers[e.id||t]=e}else this._objects.push(e)},this.addShape=function(e){if(this.map){this.map.shapes=this.map.shapes||{},e.setMap(this.map);var t=Object.keys(this.map.shapes).length;this.map.shapes[e.id||t]=e}else this._objects.push(e)},this.addObjects=function(e){for(var t=0;t<e.length;t++){var o=e[t];o instanceof google.maps.Marker?this.addMarker(o):(o instanceof google.maps.Circle||o instanceof google.maps.Polygon||o instanceof google.maps.Polyline||o instanceof google.maps.Rectangle||o instanceof google.maps.GroundOverlay)&&this.addShape(o)}}},ngMap.directives.MapController.$inject=["$scope"],ngMap.directives.marker=function(e){var t=e,o=function(e,o){var a;if(e.position instanceof google.maps.LatLng)a=new google.maps.Marker(e);else{var n=e.position;e.position=new google.maps.LatLng(0,0),a=new google.maps.Marker(e),t.setDelayedGeoLocation(a,"setPosition",n)}Object.keys(o).length>0;for(var r in o)r&&google.maps.event.addListener(a,r,o[r]);return a};return{restrict:"AE",require:"^map",link:function(e,a,n,r){var i=t.filter(n),s=t.getOptions(i,e),c=t.getEvents(e,i);s.ngRepeat&&a.bind("$destroy",function(){var e=u.map.markers;for(var t in e)e[t]==u&&delete e[t];u.setMap(null)});for(var p={},l=0;l<a[0].attributes.length;l++){var g=a[0].attributes[l];p[g.name]=g.value}var u=o(s,c);r.addMarker(u);for(var v=t.getAttrsToObserve(p),l=0;l<v.length;l++)t.observeAndSet(n,v[l],u)}}},ngMap.directives.marker.$inject=["Attr2Options"],ngMap.directives.shape=function(e){var t=e,o=function(e){return new google.maps.LatLngBounds(e[0],e[1])},a=function(e,a){var n,r=e.name;switch(delete e.name,r){case"circle":if(e.center instanceof google.maps.LatLng)n=new google.maps.Circle(e);else{var i=e.center;e.center=new google.maps.LatLng(0,0),n=new google.maps.Circle(e),t.setDelayedGeoLocation(n,"setCenter",i)}break;case"polygon":n=new google.maps.Polygon(e);break;case"polyline":n=new google.maps.Polyline(e);break;case"rectangle":e.bounds=o(e.bounds),n=new google.maps.Rectangle(e);break;case"groundOverlay":case"image":var s=e.url,c=o(e.bounds),p={opacity:e.opacity,clickable:e.clickable,id:e.id};n=new google.maps.GroundOverlay(s,c,p)}for(var l in a)a[l]&&google.maps.event.addListener(n,l,a[l]);return n};return{restrict:"AE",require:"^map",link:function(e,o,n,r){var i=t.filter(n),s=t.getOptions(i),c=t.getEvents(e,i),p=a(s,c);r.addShape(p);for(var l={},g=0;g<o[0].attributes.length;g++){var u=o[0].attributes[g];l[u.name]=u.value}for(var v=t.getAttrsToObserve(l),g=0;g<v.length;g++)t.observeAndSet(n,v[g],p)}}},ngMap.directives.shape.$inject=["Attr2Options"];var ngMapModule=angular.module("ngMap",[]);for(var key in ngMap.services)ngMapModule.service(key,ngMap.services[key]);for(var key in ngMap.directives)"MapController"!=key&&ngMapModule.directive(key,ngMap.directives[key]);